<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shorts Home</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://kit.fontawesome.com/81a03866de.js" crossorigin="anonymous"></script>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/81a03866de.js" crossorigin="anonymous"></script>

    <!-- Fancybox CSS -->
    <link href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" rel="stylesheet">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
   
    <!-- Fancybox JS -->
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
</head>
<body style="background-color: #4b0505;">
    <div class="modal-body" style="margin-block: 6rem;">

        <div class="latest-news-blog-1 text-center">
            <iframe id="shortsFrame" style="border-radius: 10px;" width="330" height="588" src="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
            <div style="margin-top: -11rem; margin-left: -8rem;">
                <div style="display: flex; justify-content: center;">
                    <div>
                        <img src="./images/global-icon.png" class="homeButton" style="width: 100%; height: 40px;"/>
                    </div>
                    <div class="mx-2">
                        <h6 class="text-white homeButton" id="authorName">Global Headlines</h5>
                        <span class="text-white fw-bold" style="font-size: 10px; text-align: justify; position: relative; top: -10px;" id="publishDate"></span>
                    </div>
                </div>
            </div>
            <p style="max-width: 20%; margin: 0 auto; text-align: justify; font-size: 0.8rem; color: #fff;" id="shortsTitle"></p>
        </div>

        
        <div style="display: grid; justify-content: center; margin-left: 28rem; margin-top: -21rem; grid-gap: 1rem;">
            <a href="index.html">
                <span style="clip-path: circle(); float: right; cursor: pointer; padding: 1.2rem; background-color: #a39c9c;">
                    <i class="fa-solid fa-house text-white fs-5"></i>
                    
                </span>
            </a>
            <span style="clip-path: circle(); float: right; cursor: pointer;">
                <img src="./images/upside-icon.png" id="upButton" />
            </span>
            <span style="clip-path: circle(); float: right; cursor: pointer;">
                <img src="./images/downside-icon.png" id="downButton" />
            </span>
            <span style="padding: 1rem; clip-path: circle(); background-color: #a39c9c; float: right; cursor: pointer;" data-fancybox data-src="#dialog-content" id="shareButton">
                <i class="fa-solid fa-share-nodes text-primary fs-4"></i>
            </span>
        </div>

    </div>

    <div id="dialog-content" style="display:none; width:500px; border-radius: 6px;">
        <div class="col-lg-4 col-sm-4">
            <div class="right-icons" id="right-icons">
                <ul>
                    <!-- WhatsApp -->
                    <li>
                        <a href="javascript:void(0);" id="whatsappLink" target="_blank">
                        <img src="./images/whatsapp.png" class="whatsapp-icon"/>
                        Whatsapp
                        </a>
                    </li>
    
                    <!-- Facebook -->
                    <li class="right-side-icons">
                        <a href="javascript:void(0);" id="facebookLink" target="_blank">
                        <img src="./images/facebook.svg" class="facebook-icon"/>
                        Facebook
                        </a>
                    </li>
    
                    <!-- Twitter -->
                    <li class="right-side-icons">
                        <a href="javascript:void(0);" id="twitterLink" target="_blank">
                        <img src="./images/twitterrrr.png" class="tweet-icon"/>
                        Twitter
                        </a>
                    </li>
    
                    <!-- Telegram -->
                    <li class="right-side-icons">
                        <a href="javascript:void(0);" id="telegramLink" target="_blank">
                        <img src="./images/telegramm.png" />
                        Telegram
                        </a>
                    </li>
    
                </ul>
            </div>
        </div>

    </div>

    <script>
 $(document).ready(function() {
            // Function to fetch and display shorts
            function fetchShortsById(currentIndex) {
                fetch(`https://49.205.196.123:4418/api/NewsMaster/GetshortsById?Id=${currentIndex}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data && data.length > 0) {
                            const shortsFrame = document.getElementById('shortsFrame');
                            const publishDate = document.getElementById('publishDate');
                            const shortsTitle = document.getElementById('shortsTitle');
                            const authorName = document.getElementById('authorName');

                            // Update video source
                            shortsFrame.src = data[0].filePath;

                            // Update publish date, title, and author name
                            publishDate.textContent = data[0].publishDate;
                            shortsTitle.textContent = data[0].title;
                            authorName.textContent = data[0].authorName;

                            // Update session with current index
                            if (!sessionStorage.getItem('contentID')) {
                                sessionStorage.setItem('contentID', currentIndex);
                            }

                            // Update URL with the new content ID
                            history.pushState({}, '', '?contentID=' + currentIndex);
                        }
                    })
                    .catch(error => console.error('Error fetching shorts:', error));
            }

            // Parse URL parameters to get the initial contentID
            const urlParams = new URLSearchParams(window.location.search);
            let currentIndex = parseInt(urlParams.get('contentID')) || 1;

            // Fetch and display initial shorts
            fetchShortsById(currentIndex);

            // Event listener for down button
            $('#downButton').on('click', function() {
                currentIndex++;
                fetchShortsById(currentIndex);
            });

            // Event listener for up button
            $('#upButton').on('click', function() {
                if (currentIndex > 1) {
                    currentIndex--;
                    fetchShortsById(currentIndex);
                }
            });


    
    // Share button click event
    $('#shareButton').on('click', function() {
        // Get the text from the element with id "shortsTitle"
        var shortsTitleText = document.getElementById('shortsTitle').innerText;
      
        // Additional information to be added to the share message
        var shareInfo = "Check out this interesting video: ";
        var currentURL = window.location.href;

        // Create the share message with dynamically obtained text
        var shareMessage = shareInfo + shortsTitleText;

        // Create the links with dynamically obtained text
        var whatsappLink = "https://api.whatsapp.com/send/?text=" + encodeURIComponent(shareMessage + " " + currentURL);
        var facebookLink = "https://www.facebook.com/sharer/sharer.php?u=" + encodeURIComponent(window.location.href);
        var twitterLink = "https://twitter.com/intent/tweet?text=" + encodeURIComponent(shareMessage + " " + currentURL);
        var telegramLink = "https://telegram.me/share/url?url=" + encodeURIComponent(window.location.href) + "&text=" + encodeURIComponent(shareMessage + " " + currentURL);

        // Set the href attributes of the anchor tags
        document.getElementById('whatsappLink').setAttribute('href', whatsappLink);
        document.getElementById('facebookLink').setAttribute('href', facebookLink);
        document.getElementById('twitterLink').setAttribute('href', twitterLink);
        document.getElementById('telegramLink').setAttribute('href', telegramLink);
    });
});
</script>
</body>
</html>
